#!/usr/bin/env python
import json
import re

def get_ip_from_specs():
    try:
        with open("/root/demo-automation/vm_specs.txt", "r") as f:
            content = f.read()
            ip_match = re.search(r"IP: (\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})", content)
            if ip_match:
                return ip_match.group(1)
    except FileNotFoundError:
        return None

if __name__ == "__main__":
    ip = get_ip_from_specs()
    if ip:
        inventory = {
            "all": {
                "hosts": [ip]
            },
            "_meta": {
                "hostvars": {}
            }
        }
        print(json.dumps(inventory))
    else:
        print(json.dumps({"_meta": {"hostvars": {}}}))
